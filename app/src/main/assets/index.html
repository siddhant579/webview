<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RPS GODS: ULTIMATE BATTLE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #00d2ff; --accent: #ff4757; --gold: #f1c40f; --bg: #050505; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: white; height: 100vh; overflow: hidden; display: flex; justify-content: center; }

        h1, h2, .logo, .score, #countdown, .target-text, .coin-text { font-family: 'Orbitron', sans-serif; letter-spacing: 1px; }

        .screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; text-align: center; background: radial-gradient(circle, #1a1a1a 0%, #050505 100%); }
        #game-page { display: none; z-index: 500; }

        .logo { font-size: 2.5rem; color: var(--primary); text-shadow: 0 0 15px var(--primary); margin-bottom: 25px; line-height: 1; }
        .logo span { display: block; font-size: 1rem; color: #fff; letter-spacing: 4px; margin-top: 5px; }

        .box { background: #111; border: 2px solid #333; padding: 20px; border-radius: 20px; width: 90%; max-width: 400px; margin-bottom: 15px; }
        .label-text { font-size: 1.1rem; font-weight: bold; margin-bottom: 10px; display: block; color: var(--primary); }

        .t-btn { background: #222; border: 1px solid #444; color: white; padding: 10px 15px; border-radius: 12px; cursor: pointer; flex: 1; font-weight: bold; font-size: 0.9rem; }
        .t-btn.active { background: var(--primary); color: #000; border-color: var(--primary); box-shadow: 0 0 10px var(--primary); }

        .start-btn { background: var(--primary); color: #000; border: none; padding: 18px 50px; border-radius: 50px; font-size: 1.3rem; font-weight: 800; cursor: pointer; margin-top: 15px; box-shadow: 0 5px 20px rgba(0, 210, 255, 0.4); }
        .reward-btn { background: var(--gold); color: #000; border: none; padding: 10px 20px; border-radius: 10px; font-weight: 800; cursor: pointer; margin-bottom: 15px; display: none; }

        .header { width: 100%; padding: 15px; display: flex; justify-content: space-between; align-items: center; background: #111; border-bottom: 1px solid #333; }
        .sound-btn { background: none; border: none; font-size: 1.8rem; cursor: pointer; }
        .score { font-size: 2.2rem; font-weight: 800; color: #fff; }

        .arena { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; width: 100%; }
        .hand { font-size: 5.5rem; transition: 0.3s; margin: 15px 0; }
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        #countdown { position: absolute; font-size: 8rem; color: var(--primary); display: none; text-shadow: 0 0 30px var(--primary); z-index: 100; }

        .controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; padding: 20px; width: 100%; max-width: 450px; }
        .move-btn { background: #1a1a1a; border: 2px solid #333; border-radius: 20px; padding: 20px; font-size: 2.5rem; cursor: pointer; transition: 0.2s; }

        /* Celebration Effect */
        #confetti { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2000; display: none; }
    </style>
</head>
<body>

    <canvas id="confetti"></canvas>
    <audio id="bgMusic" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"></audio>

    <div id="welcome-page" class="screen">
        <div class="logo">RPS GODS<span>ULTIMATE BATTLE</span></div>
        <button id="daily-reward-btn" class="reward-btn" onclick="claimDailyReward()">üéÅ CLAIM DAILY 100 COINS</button>
        <div class="box">
            <div class="coin-text" style="font-size: 1.5rem; color: var(--gold); margin-bottom: 10px;">ü™ô <span id="menu-coins">0</span></div>
            <span class="label-text">CHOOSE ROUNDS</span>
            <div style="display:flex; gap:10px;">
                <button class="t-btn active" onclick="setRounds(3, this)">3</button>
                <button class="t-btn" onclick="setRounds(5, this)">5</button>
                <button class="t-btn" onclick="setRounds(7, this)">7</button>
            </div>
        </div>
        <div class="box">
            <span class="label-text">SELECT MODE</span>
            <div style="display:flex; gap:10px;">
                <button class="t-btn active" id="m-cpu" onclick="setMode('cpu')">VS BOT</button>
                <button class="t-btn" id="m-p2" onclick="setMode('p2')">VS FRIEND</button>
            </div>
        </div>
        <button class="start-btn" onclick="startGame()">START GAME</button>
    </div>

    <div id="game-page" class="screen" style="justify-content: flex-start;">
        <div class="header">
            <button class="sound-btn" onclick="toggleSound()" id="sound-icon">üîä</button>
            <div class="coin-text" style="font-size: 1.1rem; color: var(--gold)">ü™ô <span id="game-coins">0</span></div>
            <div class="target-text" style="font-size:0.9rem; color:var(--primary)">GOAL: <span id="goal-ui">3</span></div>
            <button onclick="location.reload()" style="background:none; border:2px solid var(--accent); color:var(--accent); font-weight:bold; padding:5px 10px; border-radius:10px;">EXIT</button>
        </div>
        <div class="arena">
            <div id="countdown">3</div>
            <div style="display:flex; width:100%; justify-content: space-around; align-items: center;">
                <div style="text-align:center;"><div id="p1-hand" class="hand">‚úä</div><p style="font-weight:bold; color:var(--primary)">YOU</p></div>
                <div style="font-family:'Orbitron'; opacity:0.3; font-size:1.5rem">VS</div>
                <div style="text-align:center;"><div id="p2-hand" class="hand">‚úä</div><p id="p2-name" style="font-weight:bold; color:var(--accent)">BOT</p></div>
            </div>
            <div id="status" style="margin-top:30px; font-weight:bold; font-size:1.2rem; height:30px;">READY?</div>
            <div id="score" class="score">0 - 0</div>
        </div>
        <div class="controls">
            <button class="move-btn" onclick="input('r')">ü™®</button>
            <button class="move-btn" onclick="input('p')">üìÑ</button>
            <button class="move-btn" onclick="input('s')">‚úÇÔ∏è</button>
        </div>
    </div>

    <script>
        let config = { mode: 'cpu', target: 3, sound: true, coins: parseInt(localStorage.getItem('rps_coins')) || 0, lastDaily: localStorage.getItem('rps_last_daily') || "" };
        let state = { p1S: 0, p2S: 0, p1M: '', p2T: false, busy: false };
        const music = document.getElementById('bgMusic');

        function checkDaily() {
            let today = new Date().toDateString();
            if (config.lastDaily !== today) document.getElementById('daily-reward-btn').style.display = "block";
            document.getElementById('menu-coins').innerText = config.coins;
        }
        checkDaily();

        function claimDailyReward() {
            config.coins += 100;
            config.lastDaily = new Date().toDateString();
            localStorage.setItem('rps_coins', config.coins);
            localStorage.setItem('rps_last_daily', config.lastDaily);
            document.getElementById('menu-coins').innerText = config.coins;
            document.getElementById('daily-reward-btn').style.display = "none";
            alert("üéÅ You claimed 100 Daily Coins!");
        }

        function setRounds(r, b) { config.target = r; b.parentElement.querySelectorAll('.t-btn').forEach(btn => btn.classList.remove('active')); b.classList.add('active'); }
        function setMode(m) { config.mode = m; document.getElementById('m-cpu').classList.toggle('active', m === 'cpu'); document.getElementById('m-p2').classList.toggle('active', m === 'p2'); }
        function toggleSound() { config.sound = !config.sound; document.getElementById('sound-icon').innerText = config.sound ? 'üîä' : 'üîá'; config.sound ? music.play() : music.pause(); }

        function startGame() {
            document.getElementById('welcome-page').style.display = 'none';
            document.getElementById('game-page').style.display = 'flex';
            document.getElementById('goal-ui').innerText = config.target;
            document.getElementById('game-coins').innerText = config.coins;
            document.getElementById('p2-name').innerText = config.mode === 'cpu' ? 'BOT' : 'FRIEND';
            if(config.sound) music.play().catch(()=>{});
        }

        function input(m) {
            if(state.busy) return;
            if(config.mode === 'cpu') battle(m, ['r','p','s'][Math.floor(Math.random()*3)]);
            else {
                if(!state.p2T) { state.p1M = m; state.p2T = true; document.getElementById('status').innerText = "P1 LOCKED! P2 TURN"; }
                else { battle(state.p1M, m); state.p2T = false; }
            }
        }

        function battle(m1, m2) {
            state.busy = true;
            const h1 = document.getElementById('p1-hand');
            const h2 = document.getElementById('p2-hand');
            h1.innerText = "‚úä"; h2.innerText = "‚úä";
            h1.classList.add('shake'); h2.classList.add('shake');
            let c = 3; const cd = document.getElementById('countdown');
            cd.style.display = 'block'; cd.innerText = c;
            let timer = setInterval(() => {
                c--; if(c > 0) cd.innerText = c;
                else { clearInterval(timer); cd.style.display='none'; resolve(m1, m2); }
            }, 800);
        }

        function resolve(m1, m2) {
            const emo = {r:'‚úä', p:'‚úã', s:'‚úåÔ∏è'};
            const rules = {r:'s', p:'r', s:'p'};
            document.getElementById('p1-hand').innerText = emo[m1];
            document.getElementById('p2-hand').innerText = emo[m2];
            document.getElementById('p1-hand').classList.remove('shake');
            document.getElementById('p2-hand').classList.remove('shake');
            const status = document.getElementById('status');
            if(m1 === m2) status.innerText = "DRAW!";
            else if(rules[m1] === m2) { state.p1S++; status.innerText = "YOU POINT!"; }
            else { state.p2S++; status.innerText = (config.mode==='cpu'?'BOT':'P2') + " POINT!"; }
            document.getElementById('score').innerText = `${state.p1S} - ${state.p2S}`;

            if(state.p1S >= config.target || state.p2S >= config.target) {
                setTimeout(() => {
                    const win = state.p1S >= config.target;
                    if(win) {
                        config.coins += 20;
                        startCelebration(); // Confetti trigger
                        setTimeout(() => { alert("üèÜ MATCH WON! +20 COINS"); location.reload(); }, 2000);
                    } else {
                        config.coins = Math.max(0, config.coins - 5);
                        alert("‚ùå MATCH LOST! -5 COINS");
                        location.reload();
                    }
                    localStorage.setItem('rps_coins', config.coins);
                }, 500);
            } else { setTimeout(() => { state.busy = false; status.innerText = "NEXT ROUND?"; }, 1500); }
        }

        // --- Confetti Logic ---
        function startCelebration() {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d');
            canvas.style.display = 'block';
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            let pieces = [];
            for (let i = 0; i < 150; i++) pieces.push({ x: Math.random() * canvas.width, y: Math.random() * canvas.height - canvas.height, r: Math.random() * 6 + 4, d: Math.random() * 150, color: `hsl(${Math.random() * 360}, 100%, 50%)`, tilt: Math.random() * 10 - 10 });
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                pieces.forEach(p => {
                    ctx.beginPath(); ctx.lineWidth = p.r; ctx.strokeStyle = p.color;
                    ctx.moveTo(p.x + p.tilt + p.r / 2, p.y); ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 2);
                    ctx.stroke(); p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2; p.tilt = Math.sin(p.d) * 15;
                    if (p.y > canvas.height) p.y = -20;
                });
                requestAnimationFrame(draw);
            }
            draw();
        }
    </script>
</body>
</html
